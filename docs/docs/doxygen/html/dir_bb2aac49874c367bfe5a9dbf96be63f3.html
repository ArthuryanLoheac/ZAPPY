<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: docs/node_modules/serve-handler Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dir_bb2aac49874c367bfe5a9dbf96be63f3.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">serve-handler Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p><a href="https://github.com/vercel/serve-handler/actions/workflows/tests.yaml"><img src="https://github.com/vercel/serve-handler/actions/workflows/tests.yaml/badge.svg" alt="Tests" style="pointer-events: none;" class="inline"/></a> <a href="https://codecov.io/gh/vercel/serve-handler"><img src="https://codecov.io/gh/vercel/serve-handler/branch/main/graph/badge.svg" alt="codecov" style="pointer-events: none;" class="inline"/></a> <a href="https://packagephobia.now.sh/result?p=serve-handler"><img src="https://packagephobia.now.sh/badge?p=serve-handler" alt="install size" class="inline"/></a></p>
<p>This package represents the core of <a href="https://github.com/vercel/serve">serve</a>. It can be plugged into any HTTP server and is responsible for routing requests and handling responses.</p>
<p>In order to customize the default behaviour, you can also pass custom routing rules, provide your own methods for interacting with the file system and much more.</p>
<h1><a class="anchor" id="autotoc_md19430"></a>
Usage</h1>
<p>Get started by installing the package using <a href="https://yarnpkg.com/lang/en/">yarn</a>:</p>
<div class="fragment"><div class="line">yarn add serve-handler</div>
</div><!-- fragment --><p>You can also use <a href="https://www.npmjs.com/">npm</a> instead, if you'd like:</p>
<div class="fragment"><div class="line">npm install serve-handler</div>
</div><!-- fragment --><p>Next, add it to your HTTP server. Here's an example using <a href="https://github.com/vercel/micro">micro</a>:</p>
<div class="fragment"><div class="line">const handler = require(&#39;serve-handler&#39;);</div>
<div class="line"> </div>
<div class="line">module.exports = async (request, response) =&gt; {</div>
<div class="line">  await handler(request, response);</div>
<div class="line">};</div>
</div><!-- fragment --><p>That's it! :tada:</p>
<h1><a class="anchor" id="autotoc_md19431"></a>
Options</h1>
<p>If you want to customize the package's default behaviour, you can use the third argument of the function call to pass any of the configuration options listed below. Here's an example:</p>
<div class="fragment"><div class="line">await handler(request, response, {</div>
<div class="line">  cleanUrls: true</div>
<div class="line">});</div>
</div><!-- fragment --><p>You can use any of the following options:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Property   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">`public`   </td><td class="markdownTableBodyNone">Set a sub directory to be served    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">`cleanUrls`   </td><td class="markdownTableBodyNone">Have the <code>.html</code> extension stripped from paths    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">`rewrites`   </td><td class="markdownTableBodyNone">Rewrite paths to different paths    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">`redirects`   </td><td class="markdownTableBodyNone">Forward paths to different paths or external URLs    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">`headers`   </td><td class="markdownTableBodyNone">Set custom headers for specific paths    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">`directoryListing`   </td><td class="markdownTableBodyNone">Disable directory listing or restrict it to certain paths    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">`unlisted`   </td><td class="markdownTableBodyNone">Exclude paths from the directory listing    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">`trailingSlash`   </td><td class="markdownTableBodyNone">Remove or add trailing slashes to all paths    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">`renderSingle`   </td><td class="markdownTableBodyNone">If a directory only contains one file, render it    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">`symlinks`   </td><td class="markdownTableBodyNone">Resolve symlinks instead of rendering a 404 error    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">`etag`   </td><td class="markdownTableBodyNone">Calculate a strong <code>ETag</code> response header, instead of <code>Last-Modified</code>   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md19432"></a>
public (String)</h2>
<p>By default, the current working directory will be served. If you only want to serve a specific path, you can use this options to pass an absolute path or a custom directory to be served relative to the current working directory.</p>
<p>For example, if serving a <a href="https://jekyllrb.com/">Jekyll</a> app, it would look like this:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;public&quot;: &quot;_site&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Using absolute path:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;public&quot;: &quot;/path/to/your/_site&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>NOTE:</b> The path cannot contain globs or regular expressions.</p>
<h2><a class="anchor" id="autotoc_md19433"></a>
cleanUrls (Boolean|Array)</h2>
<p>By default, all <code>.html</code> files can be accessed without their extension.</p>
<p>If one of these extensions is used at the end of a filename, it will automatically perform a redirect with status code <a href="https://en.wikipedia.org/wiki/HTTP_301">301</a> to the same path, but with the extension dropped.</p>
<p>You can disable the feature like follows:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;cleanUrls&quot;: false</div>
<div class="line">}</div>
</div><!-- fragment --><p>However, you can also restrict it to certain paths:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;cleanUrls&quot;: [</div>
<div class="line">    &quot;/app/**&quot;,</div>
<div class="line">    &quot;/!components/**&quot;</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>NOTE:</b> The paths can only contain globs that are matched using <a href="https://github.com/isaacs/minimatch">minimatch</a>.</p>
<h2><a class="anchor" id="autotoc_md19434"></a>
rewrites (Array)</h2>
<p>If you want your visitors to receive a response under a certain path, but actually serve a completely different one behind the curtains, this option is what you need.</p>
<p>It's perfect for <a href="https://en.wikipedia.org/wiki/Single-page_application">single page applications</a> (SPAs), for example:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;rewrites&quot;: [</div>
<div class="line">    { &quot;source&quot;: &quot;app/**&quot;, &quot;destination&quot;: &quot;/index.html&quot; },</div>
<div class="line">    { &quot;source&quot;: &quot;projects/*/edit&quot;, &quot;destination&quot;: &quot;/edit-project.html&quot; }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>You can also use so-called "routing segments" as follows:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;rewrites&quot;: [</div>
<div class="line">    { &quot;source&quot;: &quot;/projects/:id/edit&quot;, &quot;destination&quot;: &quot;/edit-project-:id.html&quot; },</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>Now, if a visitor accesses <code>/projects/123/edit</code>, it will respond with the file <code>/edit-project-123.html</code>.</p>
<p><b>NOTE:</b> The paths can contain globs (matched using <a href="https://github.com/isaacs/minimatch">minimatch</a>) or regular expressions (match using <a href="https://github.com/pillarjs/path-to-regexp">path-to-regexp</a>).</p>
<h2><a class="anchor" id="autotoc_md19435"></a>
redirects (Array)</h2>
<p>In order to redirect visits to a certain path to a different one (or even an external URL), you can use this option:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;redirects&quot;: [</div>
<div class="line">    { &quot;source&quot;: &quot;/from&quot;, &quot;destination&quot;: &quot;/to&quot; },</div>
<div class="line">    { &quot;source&quot;: &quot;/old-pages/**&quot;, &quot;destination&quot;: &quot;/home&quot; }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>By default, all of them are performed with the status code <a href="https://en.wikipedia.org/wiki/HTTP_301">301</a>, but this behavior can be adjusted by setting the <code>type</code> property directly on the object (see below).</p>
<p>Just like with rewrites, you can also use routing segments:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;redirects&quot;: [</div>
<div class="line">    { &quot;source&quot;: &quot;/old-docs/:id&quot;, &quot;destination&quot;: &quot;/new-docs/:id&quot; },</div>
<div class="line">    { &quot;source&quot;: &quot;/old&quot;, &quot;destination&quot;: &quot;/new&quot;, &quot;type&quot;: 302 }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>In the example above, <code>/old-docs/12</code> would be forwarded to <code>/new-docs/12</code> with status code <a href="https://en.wikipedia.org/wiki/HTTP_301">301</a>. In addition <code>/old</code> would be forwarded to <code>/new</code> with status code <a href="https://en.wikipedia.org/wiki/HTTP_302">302</a>.</p>
<p><b>NOTE:</b> The paths can contain globs (matched using <a href="https://github.com/isaacs/minimatch">minimatch</a>) or regular expressions (match using <a href="https://github.com/pillarjs/path-to-regexp">path-to-regexp</a>).</p>
<h2><a class="anchor" id="autotoc_md19436"></a>
headers (Array)</h2>
<p>Allows you to set custom headers (and overwrite the default ones) for certain paths:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;headers&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;source&quot; : &quot;**/*.@(jpg|jpeg|gif|png)&quot;,</div>
<div class="line">      &quot;headers&quot; : [{</div>
<div class="line">        &quot;key&quot; : &quot;Cache-Control&quot;,</div>
<div class="line">        &quot;value&quot; : &quot;max-age=7200&quot;</div>
<div class="line">      }]</div>
<div class="line">    }, {</div>
<div class="line">      &quot;source&quot; : &quot;404.html&quot;,</div>
<div class="line">      &quot;headers&quot; : [{</div>
<div class="line">        &quot;key&quot; : &quot;Cache-Control&quot;,</div>
<div class="line">        &quot;value&quot; : &quot;max-age=300&quot;</div>
<div class="line">      }]</div>
<div class="line">    }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>If you define the <code>ETag</code> header for a path, the handler will automatically reply with status code <code>304</code> for that path if a request comes in with a matching <code>If-None-Match</code> header.</p>
<p>If you set a header <code>value</code> to <code>null</code> it removes any previous defined header with the same key.</p>
<p><b>NOTE:</b> The paths can only contain globs that are matched using <a href="https://github.com/isaacs/minimatch">minimatch</a>.</p>
<h2><a class="anchor" id="autotoc_md19437"></a>
directoryListing (Boolean|Array)</h2>
<p>For paths are not files, but directories, the package will automatically render a good-looking list of all the files and directories contained inside that directory.</p>
<p>If you'd like to disable this for all paths, set this option to <code>false</code>. Furthermore, you can also restrict it to certain directory paths if you want:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;directoryListing&quot;: [</div>
<div class="line">    &quot;/assets/**&quot;,</div>
<div class="line">    &quot;/!assets/private&quot;</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>NOTE:</b> The paths can only contain globs that are matched using <a href="https://github.com/isaacs/minimatch">minimatch</a>.</p>
<h2><a class="anchor" id="autotoc_md19438"></a>
unlisted (Array)</h2>
<p>In certain cases, you might not want a file or directory to appear in the directory listing. In these situations, there are two ways of solving this problem.</p>
<p>Either you disable the directory listing entirely (like shown here), or you exclude certain paths from those listings by adding them all to this config property.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;unlisted&quot;: [</div>
<div class="line">    &quot;.DS_Store&quot;,</div>
<div class="line">    &quot;.git&quot;</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>The items shown above are excluded from the directory listing by default.</p>
<p><b>NOTE:</b> The paths can only contain globs that are matched using <a href="https://github.com/isaacs/minimatch">minimatch</a>.</p>
<h2><a class="anchor" id="autotoc_md19439"></a>
trailingSlash (Boolean)</h2>
<p>By default, the package will try to make assumptions for when to add trailing slashes to your URLs or not. If you want to remove them, set this property to <code>false</code> and <code>true</code> if you want to force them on all URLs:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;trailingSlash&quot;: true</div>
<div class="line">}</div>
</div><!-- fragment --><p>With the above config, a request to <code>/test</code> would now result in a <a href="https://en.wikipedia.org/wiki/HTTP_301">301</a> redirect to <code>/test/</code>.</p>
<h2><a class="anchor" id="autotoc_md19440"></a>
renderSingle (Boolean)</h2>
<p>Sometimes you might want to have a directory path actually render a file, if the directory only contains one. This is only useful for any files that are not <code>.html</code> files (for those, `cleanUrls` is faster).</p>
<p>This is disabled by default and can be enabled like this:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;renderSingle&quot;: true</div>
<div class="line">}</div>
</div><!-- fragment --><p>After that, if you access your directory <code>/test</code> (for example), you will see an image being rendered if the directory contains a single image file.</p>
<h2><a class="anchor" id="autotoc_md19441"></a>
symlinks (Boolean)</h2>
<p>For security purposes, symlinks are disabled by default. If <code>serve-handler</code> encounters a symlink, it will treat it as if it doesn't exist in the first place. In turn, a 404 error is rendered for that path.</p>
<p>However, this behavior can easily be adjusted:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;symlinks&quot;: true</div>
<div class="line">}</div>
</div><!-- fragment --><p>Once this property is set as shown above, all symlinks will automatically be resolved to their targets.</p>
<h2><a class="anchor" id="autotoc_md19442"></a>
etag (Boolean)</h2>
<p>HTTP response headers will contain a strong <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/ETag"><code>ETag</code></a> response header, instead of a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Last-Modified"><code>Last-Modified</code></a> header. Opt-in because calculating the hash value may be computationally expensive for large files.</p>
<p>Sending an <code>ETag</code> header is disabled by default and can be enabled like this:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;etag&quot;: true</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md19443"></a>
Error templates</h1>
<p>The handler will automatically determine the right error format if one occurs and then sends it to the client in that format.</p>
<p>Furthermore, this allows you to not just specifiy an error template for <code>404</code> errors, but also for all other errors that can occur (e.g. <code>400</code> or <code>500</code>).</p>
<p>Just add a <code>&lt;status-code&gt;.html</code> file to the root directory and you're good.</p>
<h1><a class="anchor" id="autotoc_md19444"></a>
Middleware</h1>
<p>If you want to replace the methods the package is using for interacting with the file system and sending responses, you can pass them as the fourth argument to the function call.</p>
<p>These are the methods used by the package (they can all return a <code>Promise</code> or be asynchronous):</p>
<div class="fragment"><div class="line">await handler(request, response, undefined, {</div>
<div class="line">  lstat(path) {},</div>
<div class="line">  realpath(path) {},</div>
<div class="line">  createReadStream(path, config) {}</div>
<div class="line">  readdir(path) {},</div>
<div class="line">  sendError(absolutePath, response, acceptsJSON, root, handlers, config, error) {}</div>
<div class="line">});</div>
</div><!-- fragment --><p><b>NOTE:</b> It's important that – for native methods like <code>createReadStream</code> – all arguments are passed on to the native call.</p>
<h1><a class="anchor" id="autotoc_md19445"></a>
Author</h1>
<p>Leo Lamprecht (<a href="https://x.com/leo">@leo</a>) - <a href="https://vercel.com">Vercel</a> </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_49e56c817e5e54854c35e136979f97ca.html">docs</a></li><li class="navelem"><a class="el" href="dir_a0409b32ef7fd26e7246cf83548265be.html">node_modules</a></li><li class="navelem"><a class="el" href="dir_bb2aac49874c367bfe5a9dbf96be63f3.html">serve-handler</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
